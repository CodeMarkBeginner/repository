<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>设备反控</title>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/1.3.6/socket.io.min.js"></script>
    <script type="text/javascript" src="https://webapi.amap.com/maps?v=1.4.8&key=efb66f1d0e0a897af3702fdb233c0812"></script>
    <script src="static/assets/js/jquery-3.3.1.js"></script>
    <script src="static/assets/js/getParameter.js"></script>
    <!-- &lt;!&ndash;导入布局js，共享base&ndash;&gt;
     <script type="text/javascript" src="static/assets/js/include.js"></script>
     <script src="https://cdn.bootcss.com/html5shiv/3.7.3/html5shiv.min.js"></script>
     <script src="https://cdn.bootcss.com/respond.js/1.4.2/respond.min.js"></script>

     <meta name="description" content="Ela Admin - HTML5 Admin Template">
     <meta name="viewport" content="width=device-width, initial-scale=1">-->

    <link rel="stylesheet" href="static/assets/css/normalize.css">
    <link rel="stylesheet" href="static/assets/css/bootstrap.min.css">
    <link rel="stylesheet" href="static/assets/css/font-awesome.min.css">
    <link rel="stylesheet" href="static/assets/css/themify-icons.css">
    <link rel="stylesheet" href="static/assets/css/pe-icon-7-filled.css">
    <link rel="stylesheet" href="static/assets/css/flag-icon.min.css">
    <link rel="stylesheet" href="static/assets/css/cs-skin-elastic.css">
    <!-- <link rel="stylesheet" href="static/assets/css/lib/datatable/dataTables.bootstrap.min.css">-->
    <link rel="stylesheet" href="static/assets/css/style.css">

    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,600,700,800' rel='stylesheet' type='text/css'>
    <script>

    </script>
</head>
<!--{% extends 'base.html' %}

{% block style %}

{% endblock %}

{% block content %}-->
<div class="right-panel">
        <div class="content">
            <div class="animated fadeIn">
                <div class="row">

                    <div class="col-md-8">
                            <div class="card">
                                <div class="card-header" style="background-color: #ff9933">
                                    <strong>设备反控</strong>
                                </div>

                                    <div class="card-body">
                                        <div class="col col-md-3" style="display: inline-block;"><label for="location" class=" form-control-label">开关</label>
                                        </div>
                                        <button type="button" id='{{ loop.index-1 }}-on' class="btn btn-primary" onclick="control(this)" style="margin-right: 20%;"><i class="fa fa-lightbulb-o"></i>&nbsp; ON</button>
                                        <button type="button" id='{{ loop.index-1 }}-off' class="btn btn-danger" onclick="control(this)"><i class="fa fa-rss"></i>&nbsp; OFF</button>
                                    </div>
                               

                            </div><!-- /# card -->

                    </div>


                </div>
            </div><!-- .animated -->
        </div><!-- .content -->
</div>
    <script type="text/javascript">

        function control(e) {
            let equipment_info = e.id.split('-')
            let eid = '{{ eq_id }}'
            let index = equipment_info[0]
            let option = equipment_info[1]

            $.ajax({
                url:"/equipment/control/"+eq_id,    //请求的url地址
                dataType:"json",   //返回格式为json
                async:true,//请求是否异步，默认为异步，这也是ajax重要特性
                data:{
                    'switch': index,
                    option
                },    //参数值
                type:"POST",   //请求方式
                success:function(req){
                    //请求成功时处理
                    if (req.msg == 'success') {
                        alert('操作成功')
                    }else{
                        alert('操作失败')
                    }
                },
                complete:function(){
                    //请求完成的处理
                },
                error:function(){
                    //请求出错处理
                    alert('操作失败')
                }
            });
        }
    </script>
<!-- Left Panel -->

<!--引入base-->
<div id="newbase"></div>
<!--导入布局js-->
<script type="text/javascript" src="static/assets/js/include.js"></script>

</body>
</html>
